<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>PostgreSQL | Danny Blog</title>
    <meta name="description" content="A VitePress Site">
    <link rel="preload stylesheet" href="/assets/style.4a29dbf0.css" as="style">
    <script type="module" src="/assets/app.eeb43aa3.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.2ed14f66.woff2" as="font" type="font/woff2" crossorigin="">
  <link rel="modulepreload" href="/assets/chunks/framework.b62a7fb5.js">
  <link rel="modulepreload" href="/assets/chunks/theme.742dd13f.js">
  <link rel="modulepreload" href="/assets/PostgreSQL.md.0f8e0117.lean.js">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-cdbc3eb6><!--[--><!--]--><!--[--><span tabindex="-1" data-v-59736647></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-59736647> Skip to content </a><!--]--><!----><header class="VPNav" data-v-cdbc3eb6 data-v-af866a43><div class="VPNavBar has-sidebar" data-v-af866a43 data-v-c7d9fa47><div class="container" data-v-c7d9fa47><div class="title" data-v-c7d9fa47><div class="VPNavBarTitle has-sidebar" data-v-c7d9fa47 data-v-9c576d5a><a class="title" href="/" data-v-9c576d5a><!--[--><!--]--><!----><!--[-->Danny Blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-c7d9fa47><div class="curtain" data-v-c7d9fa47></div><div class="content-body" data-v-c7d9fa47><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-c7d9fa47 data-v-e9d39e41><span id="main-nav-aria-label" class="visually-hidden" data-v-e9d39e41>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-e9d39e41 data-v-439836d7 data-v-8c17ad02><!--[-->Home<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/markdown-examples.html" tabindex="0" data-v-e9d39e41 data-v-439836d7 data-v-8c17ad02><!--[-->Examples<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-c7d9fa47 data-v-71e6c37e><label title="toggle dark mode" data-v-71e6c37e data-v-0bd7692d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-0bd7692d data-v-0832a754><span class="check" data-v-0832a754><span class="icon" data-v-0832a754><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0bd7692d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0bd7692d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-c7d9fa47 data-v-8e01e811 data-v-5f80acc1><!--[--><a class="VPSocialLink" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-5f80acc1 data-v-7ed57d7c><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-c7d9fa47 data-v-39c26b17 data-v-57fdeba1><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-57fdeba1><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-57fdeba1><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-57fdeba1><div class="VPMenu" data-v-57fdeba1 data-v-97491713><!----><!--[--><!--[--><!----><div class="group" data-v-39c26b17><div class="item appearance" data-v-39c26b17><p class="label" data-v-39c26b17>Appearance</p><div class="appearance-action" data-v-39c26b17><label title="toggle dark mode" data-v-39c26b17 data-v-0bd7692d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-checked="false" data-v-0bd7692d data-v-0832a754><span class="check" data-v-0832a754><span class="icon" data-v-0832a754><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0bd7692d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0bd7692d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></label></div></div></div><div class="group" data-v-39c26b17><div class="item social-links" data-v-39c26b17><div class="VPSocialLinks social-links-list" data-v-39c26b17 data-v-5f80acc1><!--[--><a class="VPSocialLink" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-5f80acc1 data-v-7ed57d7c><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-c7d9fa47 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-cdbc3eb6 data-v-0dd52821><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-0dd52821><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-0dd52821><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-0dd52821>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-0dd52821 data-v-5cf2ce92><button class="" data-v-5cf2ce92>On this page <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-5cf2ce92><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></button><!----></div></div><aside class="VPSidebar" data-v-cdbc3eb6 data-v-309e38f2><div class="curtain" data-v-309e38f2></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-309e38f2><span class="visually-hidden" id="sidebar-aria-label" data-v-309e38f2> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-309e38f2><section class="VPSidebarItem level-0 has-active" data-v-309e38f2 data-v-488c2d65><div class="item" role="button" tabindex="0" data-v-488c2d65><div class="indicator" data-v-488c2d65></div><h2 class="text" data-v-488c2d65>Examples</h2><!----></div><div class="items" data-v-488c2d65><!--[--><div class="VPSidebarItem level-1 is-link" data-v-488c2d65 data-v-488c2d65><div class="item" data-v-488c2d65><div class="indicator" data-v-488c2d65></div><a class="VPLink link link" href="/markdown-examples.html" data-v-488c2d65 data-v-8c17ad02><!--[--><p class="text" data-v-488c2d65>Markdown Examples</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-488c2d65 data-v-488c2d65><div class="item" data-v-488c2d65><div class="indicator" data-v-488c2d65></div><a class="VPLink link link" href="/api-examples.html" data-v-488c2d65 data-v-8c17ad02><!--[--><p class="text" data-v-488c2d65>Runtime API Examples</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-488c2d65 data-v-488c2d65><div class="item" data-v-488c2d65><div class="indicator" data-v-488c2d65></div><a class="VPLink link link" href="/PostgreSQL.html" data-v-488c2d65 data-v-8c17ad02><!--[--><p class="text" data-v-488c2d65>PostgreSQL</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-488c2d65 data-v-488c2d65><div class="item" data-v-488c2d65><div class="indicator" data-v-488c2d65></div><a class="VPLink link link" href="/demo.html" data-v-488c2d65 data-v-8c17ad02><!--[--><p class="text" data-v-488c2d65>demo</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-cdbc3eb6 data-v-90aa6abd><div class="VPDoc has-sidebar has-aside" data-v-90aa6abd data-v-5bac3707><div class="container" data-v-5bac3707><div class="aside" data-v-5bac3707><div class="aside-curtain" data-v-5bac3707></div><div class="aside-container" data-v-5bac3707><div class="aside-content" data-v-5bac3707><div class="VPDocAside" data-v-5bac3707 data-v-f20c7bfd><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-f20c7bfd data-v-5b39fd9c><div class="content" data-v-5b39fd9c><div class="outline-marker" data-v-5b39fd9c></div><div class="outline-title" data-v-5b39fd9c>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-5b39fd9c><span class="visually-hidden" id="doc-outline-aria-label" data-v-5b39fd9c> Table of Contents for current page </span><ul class="root" data-v-5b39fd9c data-v-0d179d45><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-f20c7bfd></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-5bac3707><div class="content-container" data-v-5bac3707><!--[--><!--]--><div class="VPDocOutlineDropdown" data-v-5bac3707 data-v-71f16de2><button class="" data-v-71f16de2>On this page <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-71f16de2><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></button><!----></div><main class="main" data-v-5bac3707><div style="position:relative;" class="vp-doc _PostgreSQL" data-v-5bac3707><div><h1 id="postgresql" tabindex="-1">PostgreSQL <a class="header-anchor" href="#postgresql" aria-label="Permalink to &quot;PostgreSQL&quot;">​</a></h1><h2 id="download" tabindex="-1">download <a class="header-anchor" href="#download" aria-label="Permalink to &quot;download&quot;">​</a></h2><ul><li><a href="https://postgresapp.com/downloads.html" target="_blank" rel="noreferrer">runtime</a></li><li><a href="https://eggerapps.at/postico/v1.php" target="_blank" rel="noreferrer">GUI</a></li></ul><p>learn <a href="https://docs.postgresql.tw/the-sql-language/sql-syntax/4.3.-han-shu-hu-jiao" target="_blank" rel="noreferrer">https://docs.postgresql.tw/the-sql-language/sql-syntax/4.3.-han-shu-hu-jiao</a></p><h2 id="add-path-to-zshrc" tabindex="-1">add PATH to zshrc <a class="header-anchor" href="#add-path-to-zshrc" aria-label="Permalink to &quot;add PATH to zshrc&quot;">​</a></h2><p>添加PostgreSQL環境變數就可以指定psql cli默認執行的lib位置</p><div class="language-javascript="><button title="Copy Code" class="copy"></button><span class="lang">javascript=</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">~/.zshrc</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># psql</span></span>
<span class="line"><span style="color:#A6ACCD;">export PATH=$PATH:/Applications/Postgres.app/Contents/Versions/15/bin</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>以上等同 <code>&gt; /Applications/Postgres.app/Contents/Versions/15/bin/psql -p5432 &quot;danny&quot;</code></p><h2 id="db-command" tabindex="-1">DB command <a class="header-anchor" href="#db-command" aria-label="Permalink to &quot;DB command&quot;">​</a></h2><p>使用psql進入db，在pq中所有指令開頭都是反斜線開頭 <code>\help</code>則可以查看當前可用的指令（跟你設定權限有關）。 <img src="https://i.imgur.com/8r4VF9r.png" alt=""></p><p><code>\?</code>則是指令查詢工具 <code>\l</code>列出當前可用的db <img src="https://i.imgur.com/KEpKXKc.png" alt=""></p><h3 id="創建db" tabindex="-1">創建db <a class="header-anchor" href="#創建db" aria-label="Permalink to &quot;創建db&quot;">​</a></h3><p>使用pq的sql指令創建，注意在pq中所有的SQL指令結尾都一定要加;不然指令不會成功 <img src="https://i.imgur.com/6PqpCHd.png" alt=""></p><p>在查看pq admin這樣我們就成功創建test db了 <img src="https://i.imgur.com/1N6Gl5J.png" alt=""></p><h3 id="切換db" tabindex="-1">切換DB <a class="header-anchor" href="#切換db" aria-label="Permalink to &quot;切換DB&quot;">​</a></h3><p><img src="https://i.imgur.com/wfiorK2.png" alt=""></p><h3 id="data-type" tabindex="-1">data type <a class="header-anchor" href="#data-type" aria-label="Permalink to &quot;data type&quot;">​</a></h3><ul><li>char 資料有固定長度，並且都為英文數字。</li><li>nchar 資料有固定長度，但不確定是否皆為英文數字。</li><li>varchar 資料沒有固定長度，並且都為英文數字。</li><li>nvarchar 資料沒有固定長度，且不確定是否皆為英文數字。</li></ul><h3 id="創建tabel" tabindex="-1">創建tabel <a class="header-anchor" href="#創建tabel" aria-label="Permalink to &quot;創建tabel&quot;">​</a></h3><p>在創建table時psql很貼心會偵測你（）的位置來判斷增新的結尾，）代表整個table的schema，;則是執行的符號 <img src="https://i.imgur.com/ouM4PyG.png" alt=""><img src="https://i.imgur.com/TP0WZQA.png" alt=""></p><h3 id="查看當前db的table的schema" tabindex="-1">查看當前db的table的schema <a class="header-anchor" href="#查看當前db的table的schema" aria-label="Permalink to &quot;查看當前db的table的schema&quot;">​</a></h3><p><img src="https://i.imgur.com/k69l1CW.png" alt=""></p><h3 id="查看schema-info" tabindex="-1">查看schema info <a class="header-anchor" href="#查看schema-info" aria-label="Permalink to &quot;查看schema info&quot;">​</a></h3><p><img src="https://i.imgur.com/NOjz9bu.png" alt=""></p><h3 id="insert-into-database" tabindex="-1">Insert Into Database <a class="header-anchor" href="#insert-into-database" aria-label="Permalink to &quot;Insert Into Database&quot;">​</a></h3><p><img src="https://i.imgur.com/EV8QRRJ.png" alt=""></p><h3 id="查看table" tabindex="-1">查看table <a class="header-anchor" href="#查看table" aria-label="Permalink to &quot;查看table&quot;">​</a></h3><p><img src="https://i.imgur.com/v4CCa99.png" alt=""></p><h3 id="生成假資料" tabindex="-1">生成假資料 <a class="header-anchor" href="#生成假資料" aria-label="Permalink to &quot;生成假資料&quot;">​</a></h3><p><a href="https://www.mockaroo.com/" target="_blank" rel="noreferrer">mockdata</a></p><h3 id="從sql黨載入" tabindex="-1">從SQL黨載入 <a class="header-anchor" href="#從sql黨載入" aria-label="Permalink to &quot;從SQL黨載入&quot;">​</a></h3><p><img src="https://i.imgur.com/HAQ9DYg.png" alt=""></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//查看person 所有欄位</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># SELECT </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> FROM PERSON</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//查看person中欄位是first_name、last_name的資料</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># SELECT first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">last_name FROM PERSON</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//將資料已country_of_birth排序 [asc|desc]</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># SELECT first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">last_name FROM PERSON ORDER BY country_of_birth ASC</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//將資料先已id排再以email排序</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person order by id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">email</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//distinct filter重複資料</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select distinct  country_of_birth from person </span></span>
<span class="line"><span style="color:#A6ACCD;">order by country_of_birth</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//combine and in where</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person</span></span>
<span class="line"><span style="color:#A6ACCD;">where gender </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Female</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span></span>
<span class="line"><span style="color:#82AAFF;">AND</span><span style="color:#A6ACCD;"> ( country_of_birth</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Japan</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> OR country_of_birth</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">China</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> )</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person</span></span>
<span class="line"><span style="color:#A6ACCD;">where gender </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Female</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#82AAFF;">AND</span><span style="color:#A6ACCD;"> ( country_of_birth </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Japan</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">China</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) )</span></span>
<span class="line"><span style="color:#A6ACCD;">order by country_of_birth</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="condition-select" tabindex="-1">condition select <a class="header-anchor" href="#condition-select" aria-label="Permalink to &quot;condition select&quot;">​</a></h3><p><img src="https://i.imgur.com/BKbGduG.png" alt=""></p><h3 id="like是相似的operator語法-返回fileds中有符合like的敘述-代表萬用字符" tabindex="-1">like是相似的operator語法，返回fileds中有符合like的敘述，%代表萬用字符 <a class="header-anchor" href="#like是相似的operator語法-返回fileds中有符合like的敘述-代表萬用字符" aria-label="Permalink to &quot;like是相似的operator語法，返回fileds中有符合like的敘述，%代表萬用字符&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person</span></span>
<span class="line"><span style="color:#A6ACCD;">where email like </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%@google.com.%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> id  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">          email           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">-----+------------+-----------+--------------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">67</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Der        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Al Hirsi  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> dalhirsi1u@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hk </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">03</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Ghana</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">201</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Maris      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Lowey     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> mlowey5k@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hk   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">05</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">23</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> United States</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">523</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Bobbye     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Aiken     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> baikenei@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">br   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">07</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">26</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> China</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">635</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Baillie    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Sowle     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> bsowlehm@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hk   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">31</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Thailand</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">697</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Crissie    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Barcke    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> cbarckejc@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">br  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">09</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">23</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Thailand</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">749</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Norman     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Skyme     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> nskymeks@google</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">au   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">06</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">17</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Sweden</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//________@% 代表找尋7個字元後加@的email</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;"> select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person </span></span>
<span class="line"><span style="color:#A6ACCD;"> where email like </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">________@%</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;"> limit </span><span style="color:#F78C6C;">5</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> id </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">          email          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">----+------------+-----------+-------------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">9</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Freddy     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Savege    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> fsavege8@pinterest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">16</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Brazil</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Alex       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Grover    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> agrover9@wisc</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">edu       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2023</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">01</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">12</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Indonesia</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Oralla     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Harley    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> oharleyh@reddit</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">03</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> China</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Sarette    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Walder    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> swalderv@bravesites</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Netherlands</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">33</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Lynne      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Darwin    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> ldarwinw@scribd</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">28</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Cuba</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span></code></pre></div><h3 id="group-by" tabindex="-1">group by <a class="header-anchor" href="#group-by" aria-label="Permalink to &quot;group by&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select country_of_birth</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) from person</span></span>
<span class="line"><span style="color:#A6ACCD;">group by country_of_birth</span></span>
<span class="line"><span style="color:#A6ACCD;">order by country_of_birth</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                              </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p><img src="https://i.imgur.com/NKMtKSD.png" alt=""></p><h3 id="having-接在group-by-後面" tabindex="-1">having 接在group by 後面 <a class="header-anchor" href="#having-接在group-by-後面" aria-label="Permalink to &quot;having 接在group by 後面&quot;">​</a></h3><p><a href="https://www.postgresql.org/docs/9.5/functions-aggregate.html" target="_blank" rel="noreferrer">aggregate doc</a></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select country_of_birth</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) from person</span></span>
<span class="line"><span style="color:#A6ACCD;">group by country_of_birth</span></span>
<span class="line"><span style="color:#A6ACCD;">having </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F78C6C;">40</span></span>
<span class="line"><span style="color:#A6ACCD;">order by country_of_birth</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> country_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> count</span></span>
<span class="line"><span style="color:#89DDFF;">------------------+-------</span></span>
<span class="line"><span style="color:#A6ACCD;"> China            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">195</span></span>
<span class="line"><span style="color:#A6ACCD;"> Indonesia        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">120</span></span>
<span class="line"><span style="color:#A6ACCD;"> Philippines      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">43</span></span>
<span class="line"><span style="color:#A6ACCD;"> Russia           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">50</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h3 id="aggregate" tabindex="-1">aggregate <a class="header-anchor" href="#aggregate" aria-label="Permalink to &quot;aggregate&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//get avage data</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">MAX</span><span style="color:#A6ACCD;">(price) from car</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    max</span></span>
<span class="line"><span style="color:#89DDFF;">-----------</span></span>
<span class="line"><span style="color:#A6ACCD;"> $99900</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">20</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select make</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">min</span><span style="color:#A6ACCD;">(price) from car</span></span>
<span class="line"><span style="color:#A6ACCD;">group by make </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="operators" tabindex="-1">Operators <a class="header-anchor" href="#operators" aria-label="Permalink to &quot;Operators&quot;">​</a></h3><p>在sql中可以透過Operator去計算filed新值</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">#</span></span>
<span class="line"><span style="color:#A6ACCD;">select id </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> make </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Round</span><span style="color:#A6ACCD;">( price </span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">.10</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Round</span><span style="color:#A6ACCD;">( price</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">(price </span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">.10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">price from car</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><img src="https://i.imgur.com/NzfqfKw.png" alt=""></p><h3 id="alias" tabindex="-1">Alias <a class="header-anchor" href="#alias" aria-label="Permalink to &quot;Alias&quot;">​</a></h3><p>甚至你可以幫你的tabel命名</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span></span>
<span class="line"><span style="color:#A6ACCD;">select id </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> make </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">model</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Round</span><span style="color:#A6ACCD;">( price </span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">.10</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ten_percent</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">Round</span><span style="color:#A6ACCD;">( price</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">(price </span><span style="color:#89DDFF;">*</span><span style="color:#F78C6C;">.10</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">discount_after_10_percent</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">price </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">origin_price</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">car</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><img src="https://i.imgur.com/dW64jeF.png" alt=""></p><h3 id="coalesce" tabindex="-1">coalesce <a class="header-anchor" href="#coalesce" aria-label="Permalink to &quot;coalesce&quot;">​</a></h3><p>當我們下指令列出user所有email時你會發現有些人沒有email</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># slect email from person</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><img src="https://i.imgur.com/0vKTn1H.png" alt=""></p><p>這時候就可以下coalesce</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">coalesce</span><span style="color:#A6ACCD;">(email</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">envaild email</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) from person</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p><strong>hint</strong> : coalesce(arg1,arg2,...) 返回第一個非null的值</p><p><img src="https://i.imgur.com/1PXubzA.png" alt=""></p><h3 id="nullif" tabindex="-1">nullif <a class="header-anchor" href="#nullif" aria-label="Permalink to &quot;nullif&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">NULLIF</span><span style="color:#A6ACCD;"> ( expression </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> expression )</span></span>
<span class="line"></span></code></pre></div><p>NULLIF如果兩個express相等就回傳null，如果不相等就回傳第一個值。</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">nullif</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> nullif</span></span>
<span class="line"><span style="color:#89DDFF;">--------</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">nullif</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">19</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> nullif</span></span>
<span class="line"><span style="color:#89DDFF;">--------</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">100</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//demo1</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">coalesce</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">/</span><span style="color:#82AAFF;">nullif</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> coalesce</span></span>
<span class="line"><span style="color:#89DDFF;">----------</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//demo2</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">coalesce</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">null,</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> coalesce</span></span>
<span class="line"><span style="color:#89DDFF;">----------</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F78C6C;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//結合coalesce demo1跟demo2的做法是一樣的。</span></span>
<span class="line"></span></code></pre></div><h3 id="time-format" tabindex="-1">time format <a class="header-anchor" href="#time-format" aria-label="Permalink to &quot;time format&quot;">​</a></h3><p><a href="https://docs.postgresql.tw/the-sql-language/functions-and-operators/date-time-functions-and-operators" target="_blank" rel="noreferrer">備註</a></p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">              now</span></span>
<span class="line"><span style="color:#89DDFF;">-------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2023</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">04</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">00</span><span style="color:#89DDFF;">.</span><span style="color:#F78C6C;">925601</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">08</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">()::date</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    now</span></span>
<span class="line"><span style="color:#89DDFF;">------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2023</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">()::time</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">       now</span></span>
<span class="line"><span style="color:#89DDFF;">-----------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">04</span><span style="color:#A6ACCD;">:</span><span style="color:#F78C6C;">19.478294</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//在psql中日期可以累加透過interval(間隔)運算符推做日期加總</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select date </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2001-09-28</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> interval </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1 hours</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">column</span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#89DDFF;">---------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2001</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">09</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">28</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">01</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">00</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">00</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span></code></pre></div><h3 id="時間運算" tabindex="-1">時間運算 <a class="header-anchor" href="#時間運算" aria-label="Permalink to &quot;時間運算&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// etc 找出去年的時間</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">() </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> interval </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1 yaers</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">column</span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#89DDFF;">---------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">15</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">12.742052</span><span style="color:#89DDFF;">+</span><span style="color:#F78C6C;">08</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span></code></pre></div><p>但你會發現output格式多了小時，這時可以透過formate decorator只計算日期</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">()::date </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> interval </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1 years</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;">column</span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#89DDFF;">---------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">00</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">00</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">00</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span></code></pre></div><p>或是可以在簡化成以下的output</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span><span style="color:#82AAFF;">select</span><span style="color:#A6ACCD;"> (</span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">() </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> interval </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">1 years</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)::date</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    date</span></span>
<span class="line"><span style="color:#89DDFF;">------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//extract </span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">extract</span><span style="color:#A6ACCD;">(year from </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> extract</span></span>
<span class="line"><span style="color:#89DDFF;">---------</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">2023</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//甚至可以選取世紀</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#82AAFF;">extract</span><span style="color:#A6ACCD;">(century from </span><span style="color:#82AAFF;">now</span><span style="color:#A6ACCD;">())</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;"> extract</span></span>
<span class="line"><span style="color:#89DDFF;">---------</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">21</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span></code></pre></div><h3 id="計算歲數" tabindex="-1">計算歲數 <a class="header-anchor" href="#計算歲數" aria-label="Permalink to &quot;計算歲數&quot;">​</a></h3><div class="language-javescript"><button title="Copy Code" class="copy"></button><span class="lang">javescript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny=# </span></span>
<span class="line"><span style="color:#A6ACCD;">select first_name ,last_name,date_of_birth,age(now()::date,date_of_birth) as age from person;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><img src="https://i.imgur.com/mi6P4TI.png" alt=""></p><h3 id="修改table-欄位-alter-table" tabindex="-1">修改table 欄位（ALTER TABLE） <a class="header-anchor" href="#修改table-欄位-alter-table" aria-label="Permalink to &quot;修改table 欄位（ALTER TABLE）&quot;">​</a></h3><p>移除pkey,constraint則是用來約束欄位的宣告例如宣告pkey就要加constraint</p><div class="language-javascript="><button title="Copy Code" class="copy"></button><span class="lang">javascript=</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny=# </span></span>
<span class="line"><span style="color:#A6ACCD;">alter table person drop constraint person_pkey;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>新增主鍵，注意如果要宣告的欄位如果資料重複會無法宣告主鍵</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person where id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> id </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">          email           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">----+------------+-----------+--------------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rafa       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Hallagan  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rhallagan0@amazonaws</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Japan</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rafa       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Hallagan  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rhallagan0@amazonaws</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Japan</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># alter table person add primary </span><span style="color:#82AAFF;">key</span><span style="color:#A6ACCD;">(id)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//如果你要射pk的欄位data有重複就不能設置主鍵</span></span>
<span class="line"><span style="color:#FFCB6B;">ERROR</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  could not create unique index </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">person_pkey</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">DETAIL</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">Key</span><span style="color:#A6ACCD;"> (id)</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) is duplicated</span><span style="color:#89DDFF;">.</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//解決方法重新新增唯一性data</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">delete</span><span style="color:#A6ACCD;"> from person where id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># insert into </span><span style="color:#82AAFF;">person</span><span style="color:#A6ACCD;"> (id</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> last_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> email</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> gender</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> date_of_birth</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> country_of_birth) </span><span style="color:#82AAFF;">values</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Rafa</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hallagan</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rhallagan0@amazonaws.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Female</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">12/20/2022</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Japan</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><h3 id="查詢email重否重複" tabindex="-1">查詢email重否重複 <a class="header-anchor" href="#查詢email重否重複" aria-label="Permalink to &quot;查詢email重否重複&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select email </span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) from person</span></span>
<span class="line"><span style="color:#A6ACCD;">group by email</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>圖中表示有304位person是沒有email的 <img src="https://i.imgur.com/A8laTIM.png" alt=""></p><h3 id="將group-by-結果做having" tabindex="-1">將group by 結果做having <a class="header-anchor" href="#將group-by-結果做having" aria-label="Permalink to &quot;將group by 結果做having&quot;">​</a></h3><p>裡會發現304個null email，而duplicate email則是rhallagan0@amazonaws.com跟 <a href="mailto:rchaster1@wiley.com" target="_blank" rel="noreferrer">rchaster1@wiley.com</a> ，分別是3位跟2位</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select email</span><span style="color:#89DDFF;">,</span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) from person group by email having </span><span style="color:#82AAFF;">count</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">&gt;</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                                                                      </span></span>
<span class="line"><span style="color:#A6ACCD;">          email           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> count</span></span>
<span class="line"><span style="color:#89DDFF;">--------------------------+-------</span></span>
<span class="line"><span style="color:#A6ACCD;">                          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">304</span></span>
<span class="line"><span style="color:#A6ACCD;"> rhallagan0@amazonaws</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;"> rchaster1@wiley</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span></code></pre></div><p>這時候將duplicate的email list出來，你會發現當我要發送rchaster1@wiley.com 的mail，你會不知道到底發給誰，這時候我們就要做unique fileds</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person where email </span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">rchaster1@wiley.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  id  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">        email        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">------+------------+-----------+---------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rich       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Chaster   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rchaster1@wiley</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">08</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Germany</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1003</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Danny       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Wu   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rchaster1@wiley</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">11</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">06</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Germany</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span></code></pre></div><p>先移除duplicate的data</p><div class="language-javascript="><button title="Copy Code" class="copy"></button><span class="lang">javascript=</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny=# select * from person where email =&#39;rchaster1@wiley.com&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  id  | first_name | last_name |        email        | gender | date_of_birth | country_of_birth</span></span>
<span class="line"><span style="color:#A6ACCD;">------+------------+-----------+---------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">    2 | Rich       | Chaster   | rchaster1@wiley.com | Male   | 2022-08-25    | Germany</span></span>
<span class="line"><span style="color:#A6ACCD;"> 1003 | Rich       | Chaster   | rchaster1@wiley.com | Male   | 2022-08-25    | Germany</span></span>
<span class="line"><span style="color:#A6ACCD;">(2 rows)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">danny=# delete from person where id = 1003;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">danny=# select * from person where email =&#39;rhallagan0@amazonaws.com&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;">  id  | first_name | last_name |          email           | gender | date_of_birth | country_of_birth</span></span>
<span class="line"><span style="color:#A6ACCD;">------+------------+-----------+--------------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> 1001 | Rafa       | Hallagan  | rhallagan0@amazonaws.com | Female | 2022-12-20    | Japan</span></span>
<span class="line"><span style="color:#A6ACCD;"> 1002 | Rafa       | Hallagan  | rhallagan0@amazonaws.com | Female | 2022-12-20    | Japan</span></span>
<span class="line"><span style="color:#A6ACCD;">    1 | Rafa       | Hallagan  | rhallagan0@amazonaws.com | Female | 2022-12-20    | Japan</span></span>
<span class="line"><span style="color:#A6ACCD;">(3 rows)</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">danny=# delete from person where id in (&#39;1001&#39;,&#39;1002&#39;);</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>當使用constraint後的field，如果在insert duplicate的data就會出現警告， constraint 用於約束table field用法會是[method] constraint [constraint_key] [限制條件]</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny=#  alter table person add constraint unique_email_address UNIQUE(email);</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">danny=# insert into person (first_name, last_name, email, gender, date_of_birth, country_of_birth) values (&#39;Rich&#39;, &#39;Chaster&#39;, &#39;rchaster1@wiley.com&#39;, &#39;Male&#39;, &#39;8/25/2022&#39;, &#39;Germany&#39;);</span></span>
<span class="line"><span style="color:#A6ACCD;">ERROR:  duplicate key value violates unique constraint &quot;unique_email_address&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">DETAIL:  Key (email)=(rchaster1@wiley.com) already exists</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>移除constraint [key]</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># alter table person drop constraint </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unique_email_address</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">ALTER TABLE</span></span>
<span class="line"></span></code></pre></div><p>distinct常用於select field中資料的type</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select distinct gender from person</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   gender</span></span>
<span class="line"><span style="color:#89DDFF;">-------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> Genderqueer</span></span>
<span class="line"><span style="color:#A6ACCD;"> Bigender</span></span>
<span class="line"><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#A6ACCD;"> Genderfluid</span></span>
<span class="line"><span style="color:#A6ACCD;"> Male</span></span>
<span class="line"><span style="color:#A6ACCD;"> Non</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">binary</span></span>
<span class="line"><span style="color:#A6ACCD;"> Polygender</span></span>
<span class="line"><span style="color:#A6ACCD;"> Female</span></span>
<span class="line"><span style="color:#A6ACCD;"> Agender</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">9</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span></code></pre></div><h3 id="刪除不要的option資料" tabindex="-1">刪除不要的option資料 <a class="header-anchor" href="#刪除不要的option資料" aria-label="Permalink to &quot;刪除不要的option資料&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select distinct gender from person</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">   gender</span></span>
<span class="line"><span style="color:#89DDFF;">-------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> Male</span></span>
<span class="line"><span style="color:#A6ACCD;"> Non</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">binary</span></span>
<span class="line"><span style="color:#A6ACCD;"> Polygender</span></span>
<span class="line"><span style="color:#A6ACCD;"> Female</span></span>
<span class="line"><span style="color:#A6ACCD;"> hello</span></span>
<span class="line"><span style="color:#A6ACCD;"> Agender</span></span>
<span class="line"><span style="color:#A6ACCD;"> Genderfluid</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;"> rows)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">delete</span><span style="color:#A6ACCD;"> from person</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"># where gender </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Non-binary</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Polygender</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Agender</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Genderfluid</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><p>之後新增constraint到table field這樣之後insert data時，gender必須是&#39;Male&#39;,&#39;Female&#39;否則會報錯</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># alter table person add constraint gender_constraint </span><span style="color:#82AAFF;">check</span><span style="color:#A6ACCD;"> (gender </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Male</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Female</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="delete-table" tabindex="-1">delete table <a class="header-anchor" href="#delete-table" aria-label="Permalink to &quot;delete table&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># </span><span style="color:#89DDFF;">delete</span><span style="color:#A6ACCD;"> from person where id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">501</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">DELETE </span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span></code></pre></div><h3 id="update-table" tabindex="-1">update table <a class="header-anchor" href="#update-table" aria-label="Permalink to &quot;update table&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># UPDATE  person   SET email</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hiunji64@gmail.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> WHERE id </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">13</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">UPDATE </span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># UPDATE person SET first_name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Danny</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">last_name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Wu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> WHERE id </span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">14</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h3 id="檢查constraint欄位-如果value-duplicate就不操作db" tabindex="-1">檢查constraint欄位，如果value duplicate就不操作db <a class="header-anchor" href="#檢查constraint欄位-如果value-duplicate就不操作db" aria-label="Permalink to &quot;檢查constraint欄位，如果value duplicate就不操作db&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># insert into </span><span style="color:#82AAFF;">person</span><span style="color:#A6ACCD;"> (first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> last_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> email</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> gender</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> date_of_birth</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> country_of_birth) </span><span style="color:#82AAFF;">values</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Rich</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Chaster</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hello@wiley.com</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Male</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">8/25/2022</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Germany</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) ON </span><span style="color:#82AAFF;">CONFLICT</span><span style="color:#A6ACCD;">(email) DO NOTHING</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">INSERT </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span></span>
<span class="line"></span></code></pre></div><p>ON CONFLICT的參數只能是有constraint過的欄位如果沒有會報錯，例如ON CONFLICT(first_name) ，DO NOTHING代表一個action,如果inset的data沒有符合constraint的要求會就不做db操作</p><h3 id="conflict-update" tabindex="-1">conflict update <a class="header-anchor" href="#conflict-update" aria-label="Permalink to &quot;conflict update&quot;">​</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person where id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1006</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  id  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">       email        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">------+------------+-----------+--------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1006</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rich       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Chaster   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> hello@wiley</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">uk </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">08</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Germany</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># insert into </span><span style="color:#82AAFF;">person</span><span style="color:#A6ACCD;"> (first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> last_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> email</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> gender</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> date_of_birth</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> country_of_birth) </span><span style="color:#82AAFF;">values</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Danny</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Wu</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Danny@wiley.com.uk</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Male</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">8/25/2022</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Germany</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) ON </span><span style="color:#82AAFF;">CONFLICT</span><span style="color:#A6ACCD;">(email) DO UPDATE SET email</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">EXCLUDED</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">email</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">first_name</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">EXCLUDED</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">last_name</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">EXCLUDED</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">last_name</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">INSERT </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person where id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1006</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  id  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> last_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">       email        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> gender </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> date_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> country_of_birth</span></span>
<span class="line"><span style="color:#89DDFF;">------+------------+-----------+--------------------+--------+---------------+------------------</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1006</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rich       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Chaster   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> hello@wiley</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">uk </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male   </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">08</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Germany</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> row)</span></span>
<span class="line"></span></code></pre></div><p>我們可以透過ON CONFLICT後重寫入db資料</p><h3 id="主鍵外來鍵" tabindex="-1">主鍵外來鍵 <a class="header-anchor" href="#主鍵外來鍵" aria-label="Permalink to &quot;主鍵外來鍵&quot;">​</a></h3><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">person</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">	id </span><span style="color:#C792EA;">bigserial</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	first_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	last_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	email </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">	gender </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	date_of_birth </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">	car_id </span><span style="color:#C792EA;">BIGINT</span><span style="color:#A6ACCD;"> ,</span></span>
<span class="line"><span style="color:#A6ACCD;">	country_of_birth </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#C792EA;">CONSTRAINT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">person_car_fkey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">FOREIGN KEY</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">car_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">REFERENCES</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">ON DELETE CASCADE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> CASCADE</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">-- CONSTRAINT car_id BIGINT REFERENCES car (id),</span></span>
<span class="line"><span style="color:#89DDFF;">	</span><span style="color:#676E95;font-style:italic;">-- UNIQUE(car_id)</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p>將id為1的person設定car編號</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">#  update person set car_id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> where id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">1</span></span>
<span class="line"></span></code></pre></div><p>如果今天foreign key不存在sql會給你提示</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># update person set car_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10000</span><span style="color:#A6ACCD;"> where id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#FFCB6B;">ERROR</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  insert or update on table </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">person</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> violates foreign key constraint </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">person_car_fkey</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#FFCB6B;">DETAIL</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">  </span><span style="color:#82AAFF;">Key</span><span style="color:#A6ACCD;"> (car_id)</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">10000</span><span style="color:#A6ACCD;">) is not present </span><span style="color:#89DDFF;">in</span><span style="color:#A6ACCD;"> table </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">car</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">.</span></span>
<span class="line"></span></code></pre></div><h3 id="更改result-select-format" tabindex="-1">更改result select format <a class="header-anchor" href="#更改result-select-format" aria-label="Permalink to &quot;更改result select format&quot;">​</a></h3><p>\x是讓你決定你的Expanded display ，他是一個toggle 指令，呼叫一次開啟在呼叫一次關閉</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># \x</span></span>
<span class="line"><span style="color:#A6ACCD;">Expanded display is on</span><span style="color:#89DDFF;">.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">----+-----------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Win</span></span>
<span class="line"><span style="color:#A6ACCD;">last_name        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Twede</span></span>
<span class="line"><span style="color:#A6ACCD;">email            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> wtwede2@so</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">net</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ne</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">jp</span></span>
<span class="line"><span style="color:#A6ACCD;">gender           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male</span></span>
<span class="line"><span style="color:#A6ACCD;">date_of_birth    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">10</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">06</span></span>
<span class="line"><span style="color:#A6ACCD;">car_id           </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">country_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Colombia</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">----+-----------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Obie</span></span>
<span class="line"><span style="color:#A6ACCD;">last_name        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Fitter</span></span>
<span class="line"><span style="color:#A6ACCD;">email            </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">gender           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male</span></span>
<span class="line"><span style="color:#A6ACCD;">date_of_birth    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2023</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">02</span></span>
<span class="line"><span style="color:#A6ACCD;">car_id           </span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">country_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Philippines</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># \x</span></span>
<span class="line"><span style="color:#A6ACCD;">Expanded display is off</span><span style="color:#89DDFF;">.</span></span>
<span class="line"></span></code></pre></div><h3 id="inner-join" tabindex="-1">inner join <a class="header-anchor" href="#inner-join" aria-label="Permalink to &quot;inner join&quot;">​</a></h3><p>inner join是table的fk 與reference的pk的聯合查詢，指令 join [fk_table] on [pk_table][field_id]=[fk_table][field_id] ;</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> from person</span></span>
<span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"># join car on person</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">car_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> car</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">----+-------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Shepard</span></span>
<span class="line"><span style="color:#A6ACCD;">last_name        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Cana</span></span>
<span class="line"><span style="color:#A6ACCD;">email            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> scanaa@cloudflare</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">gender           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Male</span></span>
<span class="line"><span style="color:#A6ACCD;">date_of_birth    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">07</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">23</span></span>
<span class="line"><span style="color:#A6ACCD;">car_id           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">country_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Ethiopia</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">make             </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Chevrolet</span></span>
<span class="line"><span style="color:#A6ACCD;">model            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Express </span><span style="color:#F78C6C;">1500</span></span>
<span class="line"><span style="color:#A6ACCD;">price            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">52723.00</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">----+-------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rafa</span></span>
<span class="line"><span style="color:#A6ACCD;">last_name        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Hallagan</span></span>
<span class="line"><span style="color:#A6ACCD;">email            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rhallagan0@amazonaws</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">gender           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Female</span></span>
<span class="line"><span style="color:#A6ACCD;">date_of_birth    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2022</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">20</span></span>
<span class="line"><span style="color:#A6ACCD;">car_id           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">country_of_birth </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Japan</span></span>
<span class="line"><span style="color:#A6ACCD;">id               </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">make             </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> MINI</span></span>
<span class="line"><span style="color:#A6ACCD;">model            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Cooper Clubman</span></span>
<span class="line"><span style="color:#A6ACCD;">price            </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30005.00</span></span>
<span class="line"></span></code></pre></div><p>你會發現output顯示太多欄位，就可以在select時指定要顯示的內容如下：</p><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">danny</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"># select person</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">first_name</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">person</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">email</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;">car</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">make from person</span></span>
<span class="line"><span style="color:#A6ACCD;">join car on person</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">car_id</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">car</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Shepard</span></span>
<span class="line"><span style="color:#A6ACCD;">email      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> scanaa@cloudflare</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">make       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Chevrolet</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">[ RECORD </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> ]</span><span style="color:#89DDFF;">------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">first_name </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Rafa</span></span>
<span class="line"><span style="color:#A6ACCD;">email      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> rhallagan0@amazonaws</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">com</span></span>
<span class="line"><span style="color:#A6ACCD;">make       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> MINI</span></span>
<span class="line"></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-5bac3707 data-v-24ebe4e9><!--[--><!--]--><!----><div class="prev-next" data-v-24ebe4e9><div class="pager" data-v-24ebe4e9><a class="pager-link prev" href="/api-examples.html" data-v-24ebe4e9><span class="desc" data-v-24ebe4e9>Previous page</span><span class="title" data-v-24ebe4e9>Runtime API Examples</span></a></div><div class="has-prev pager" data-v-24ebe4e9><a class="pager-link next" href="/demo.html" data-v-24ebe4e9><span class="desc" data-v-24ebe4e9>Next page</span><span class="title" data-v-24ebe4e9>demo</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"demo.md\":\"f010b7bc\",\"index.md\":\"e7e97bdb\",\"packages_bar.md\":\"4e58e0ce\",\"packages_foo.md\":\"91714668\",\"markdown-examples.md\":\"5e02b0cc\",\"api-examples.md\":\"a840fe25\",\"packages_index.md\":\"c75e79c0\",\"postgresql.md\":\"0f8e0117\"}")
__VP_SITE_DATA__ = JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Danny Blog\",\"description\":\"A VitePress Site\",\"base\":\"/\",\"head\":[],\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"Examples\",\"link\":\"/markdown-examples\"}],\"sidebar\":[{\"text\":\"Examples\",\"items\":[{\"text\":\"Markdown Examples\",\"link\":\"/markdown-examples\"},{\"text\":\"Runtime API Examples\",\"link\":\"/api-examples\"},{\"text\":\"PostgreSQL\",\"link\":\"/PostgreSQL\"},{\"text\":\"demo\",\"link\":\"/demo\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}]},\"locales\":{},\"scrollOffset\":90,\"cleanUrls\":false}")</script>
    
  </body>
</html>